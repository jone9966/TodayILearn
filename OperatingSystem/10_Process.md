## Ch10 프로세스와 스레드
### 프로세스
- 프로세스란 실행중인 프로그램을 의미하며 메모리에 적재된 프로그램을 뜻한다.
- 사용자가 보는 곳에서 실행되는 프로그램을 포그라운드 프로세스라고 부르고 보이지 않는 곳에서 실행되는 프로그램을 백그라운드 프로세스라고 부른다.
- 백그라운드 프로세스 중에 사용자와 상호작용하지 않고 서비스를 제공하는 프로세스를 데몬이라고 부른다.

**프로세스 제어 블록**
- 프로세스 제어 블록(PCB)는 프로세스에 대한 정보를 저장하고 있는 자료 구조로써 프로세스를 식별하기 위해 꼭 필요한 정보들을 가지고 있다.
- PCB는 커널 영역에 생성되며 사용자 영역에 적재된 프로세스들에 대한 정보를 가진다.
- PCB에는 프로세스 ID, 레지스터 값, 프로세스 상태, 메모리 관리 정보, CPU 스케줄링 정보, 자원 사용 정보 등이 담긴다.
- CPU는 한번에 하나의 프로세스만 실행할 수 있기 때문에 메모리의 많은 프로세스들이 번갈아 가면서 실행된다.
- CPU에서 실행되던 프로세스가 다른 프로세스로 바뀔 때 실행하던 프로세스의 정보들을 PCB에 저장하고 PCB에 있던 다음 프로세스의 정보를 불러오는 것을 문맥 교환(context switching) 이라고 한다.

**프로세스 메모리 영역**
- 프로세스에 프로그램이 적재되면 커널 영역에는 PCB가 생기고 사용자 영역에는 코드 영역, 데이터 영역, 힙 영역, 스택 영역이 할당된다.
- 코드 영역에는 실행할 명령어가, 데이터 영역에는 프로그램이 실행하는 동안 사용할 데이터(전역 변수 등)이 적재되기 때문에 크기가 고정되어 있다. 이를 정적 할당 영역 이라고 부른다.
- 힙 영역은 사용자가 프로그래밍 과정에서 직접 할당할 수 있는 저장 공간이며 사용을 다 한 후에는 할당한 공간을 반환해야 한다.
- 메모리 누수: 할당한 힙 메모리 공간을 반환하지 않아 메모리 낭비가 일어나는 현상
- 스택 영역은 프로그램이 실행되는 동안 일시적으로 사용할 데이터들의 공간으로 지역 변수나 매개 변수등이 해당된다.
- 힙 영역과 스택 영역은 프로그램이 실행되는 동안 계속해서 변하는 영역이기 때문에 동적 할당 영역이라고 부른다.

**프로세스 상태**
- 프로세스는 실행되는 과정에서 여러 상태를 거치게 된다.
- 생성 상태(create): 메모리에 적재되고 PCB를 할당받는 상태
- 준비 상태(ready): 생성이 완료되어 CPU가 할당되기를 기다리는 상태
- 실행 상태(running): CPU를 할당 받아 실행 중인 상태
- 대기 상태(blocked): 입출력 등 CPU외의 작업을 처리하기 위해 기다리는 상태
- 종료 상태(terminated): 프로세스가 종료되어 메모리를 정리하는 상태

**프로세스 계층 구조**
- 프로세스는 실행 도중 시스템 콜을 통해 새로운 프로세스를 생성할 수 있는데 이 때 기존에 실행되던 프로세스를 부모 프로세스라 하고 새로 생성된 프로세스를 자식 프로세스라 한다.
- 부모 프로세스는 fork를 통해 자신의 복사본으로 자식 프로세스를 생성한다.
- 자식 프로세스는 exec을 통해 자신의 메모리 공간을 다른 프로그램으로 교체한다.

### 스레드
- 프로세스를 구성하는 실행의 흐름 단위
- 스레드는 프로세스 내에서 각기 다른 스레드ID, 레지스터 값, 스택으로 구성된다.
- 스레드는 실행에 필요한 최소한의 정보만 유지한 채 프로세스의 자원을 공유하며 실행된다.

### 멀티 프로세스와 멀티 스레드
- 여러 프로세스가 동시에 실행되는 것을 멀티 프로세스
- 하나의 프로세스를 여러 스레드를 통해 실행하는 것이 멀티 스레드
- 멀티 프로세스는 각각 고유의 프로세스로 실행되지만 멀티 스레드는 하나의 프로세스에서 자원을 공유하며 실행되기 때문에 자원을 효율적으로 사용할 수 있다.
- 하지만 동일한 자원을 사용해서 동시에 실행된다는 것은 해당 자원들이 변경 되었을 때 조심해야 한다.
- 또한 멀티 스레드의 경우 하나의 스레드에 문제가 생길 경우에 프로세스 전체에 영향이 갈 수 있다.