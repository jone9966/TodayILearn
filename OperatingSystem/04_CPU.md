## Ch04 CPU의 작동 원리

- CPU(Central Processing Unit)는 명령어를 읽어서 해석하고 실행하는 장치로 ALU, 제어 장치, 레지스터로 구성된다.

### ALU(Arithmetic and Logical Unit)
- ALU는 산술 논리 연산장치로 계산을 담당한다.
- ALU는 레지스터를 통해 피연산자를 받아들이고, 제어 장치로부터 수행할 연산에 대한 제어 신호를 받아서 연산을 수행하고 결과값을 내보낸다.
- ALU가 내보내는 결과값은 특정 숫자나 문자, 메모리 주소 등이 될 수 있으며 일시적으로 레지스터에 저장되었다가 메모리로 이동한다.
- ALU는 결과값 외에 연산 결과에 대한 추가적인 상태 정보인 플래그를 플래그 레지스터로 내보낸다.
- 대표적인 플래그로는 부호 플래그, 제로 플래그, 캐리 플래그, 오버플로우 플래그, 인터럽트 플래그, 슈퍼바이저 플래그 등이 있다.

### 제어 장치(Control Unit)
- 제어 장치는 명령어를 해석하고 컴퓨터 부품들을 관리하고 작동시키는 제어 신호를 내보내는 부품이다.
- 제어 장치는 클럭 신호, 해석해야 할 명령어, 플래그 값, 제어 신호 등을 받아들인다.
- 제어 장치는 레지스터, ALU, 메모리, 입출력장치 등으로 제어 신호를 내보낸다.

### 레지스터
- 레지스터는 CPU 안에 존재하는 작은 저장장치로 다양한 종류가 있다.
- 프로그램 카운터(Program Counter): 다음에 메모리에서 가져올 명령어의 주소를 저장, Instruction Pointer 라고도 한다.
- 명령어 레지스터(Instruction Register): 메모리에서 읽어 들인, 해석할 명령어를 저장하는 레지스터
- 메모리 주소 레지스터(Memory Address Register): CPU가 읽어 들이고자 하는 메모리의 주소를 저장하는 레지스터
- 메모리 버퍼 레지스터(Memory Buffer Register): 메모리와 주고받을 데이터 혹은 명령어를 저장하는 레지스터
- 범용 레지스터: 자유롭게 사용할 수 있는 레지스터
- 플래그 레지스터: ALU 연산 결과에 따른 플래그 정보를 저장하는 레지스터
- 스택 포인터: 스택에 마지막으로 저장한 값의 위치를 저장하는 레지스터
- 베이스 레지스터: 기준 주소를 저장하는 레지스터

### 명령어 사이클
- 명령어 사이클은 하나의 명령어를 처리하는 정형화된 흐름이다.
- 명령어 사이클은 인출 사이클, 실행 사이클, 간접 사이클, 인터럽트 사이클로 구성된다.
    - 인출 사이클: 메모리에 있는 명령어를 CPU로 가져오는 단계
    - 실행 사이클: 가져온 명령어를 해석하고 제어 신호를 발생시키는 단계
    - 간접 사이클: 추가적인 메모리 접근을 처리하는 단계
    - 인터럽트 사이클: 인터럽트를 처리하는 단계

### 인터럽트
- 인터럽트는 CPU의 정상적인 작업을 방해하는 신호
- 인터럽트는 CPU에 의해 발생하는 인터럽트인 동기 인터럽트(예외)와 입출력 장치 등에 의해 발생하는 비동기 인터럽트(하드웨어 인터럽트)로 나뉜다.
- 동기 인터럽트인 예외에는 폴트, 트랩, 중단, 소프트웨어 인터럽트가 있다.
    - 폴트: 인터럽트가 발생한 명령어부터 실행을 재개하는 예외
    - 트랩: 인터럽트가 발생한 명령어의 다음 명령어부터 실행을 재개하는 예외
    - 중단: CPU가 실행중인 프로그램을 강제로 중단하는 예외
    - 소프트웨어 인터럽트: 시스템콜이 발생했을 때 나타나는 예외
- 하드웨어 인터럽트는 CPU와 하드웨어의 처리 속도 차이 때문에 CPU의
- 인터럽트 요청 신호 → 인터럽트 플래그 → 인터럽트 벡터 → 인터럽트 서비스 루틴 실행
    - 인터럽트 플래그: CPU가 인터럽트를 처리할 수 있는 상태인지 표시
    - 인터럽트 벡터: 각 인터럽트를 처리하기 위해 수행 해야할 서비스 루틴 식별 정보
    - 인터럽트 서비스 루틴(ISR): 인터럽트를 처리하기 위한 프로그램