## Ch14 가상 메모리

### 연속 메모리 할당
- 연속 메모리 할당이란 프로세스에 연속적인 메모리 공간을 할당하는 방식
- 스와핑: 메모리에 적재된 프로세스 중 현재 실행되지 않는 프로세스를 보조기억장치로 옮기고 다른 프로세스를 적재하여 실행하는 방식
- **메모리 할당 방식**
    - 최초 적합: 적재될 수 있는 공간 중 제일 먼저 발견한 공간에 할당
    - 최적 적합: 프로세스가 적재될 수 있는 공간 중 제일 작은 공간에 할당
    - 최악 적합: 프로세스가 적재될 수 있는 공간 중 제일 큰 공간에 할당
- 외부 단편화: 메모리를 연속적으로 사용하는 환경에서 프로세스들이 실행과 종료를 반복하며 빈 공간들이 발생하는 것
- 압축(메모리 조각 모음)을 통해 빈 공간들을 합쳐 외부 단편화 제거 → 오버헤드 발생

### 가상 메모리 관리
- 가상 메모리: 실행하고자 하는 프로그램을 일부만 메모리에 적재하여 실제 물리 메모리 크기보다 더 큰 프로세스를 실행할 수 있게 하는 기술
- 가상 메모리 관리 기법에는 페이징과 세그멘테이션이 존재한다.

**페이징**
- 프로세스의 논리 주소 공간을 페이지 단위로 나누어 메모리에 적재하는 방법
- 메모리 물리 주소 공간을 페이지와 같은 크기의 프레임 단위로 나누어 페이지를 할당
- 메모리에 적재된(PCB) 페이지 테이블에 페이지와 프레임 외에 다양한 비트 정보들이 저장
    - 유효 비트: 페이지가 메모리에 있는지
    - 보호 비트: 읽기 전용인지
    - 참조 비트: CPU가 페이지에 접근한 적이 있는지
    - 수정 비트: 해당 페이지에 데이터를 쓴 적이 있는지
- CPU의 페이지 테이블 베이스 레지스터(PTBR)에는 페이지 테이블의 주소가 저장
- CPU가 메모리에 두 번 접근하는 것을 막기 위해 TLB(페이지 테이블의 캐시 메모리) 사용
- 페이징 시스템에서는 논리 주소를 페이지 번호 + 변위로 표현

### 페이지 관리
- 운영체제는 한정된 메모리를 효율적으로 이용할 수 있도록 페이지를 관리한다.
- 요구 페이징은 처음부터 프로세스의 모든 페이지를 적재하지 않고 실행에 요구되는 페이지만 적재하는 기법

**페이지 교체 알고리즘**
- 메모리가 가득 찰 경우 스왑할 페이지를 어떻게 정하느냐에 따라 페이지 폴트의 빈도가 변함
- FIFO 페이지 교체 알고리즘: 먼저 들어온 페이지를 먼저 교체
- 최적 페이지 교체 알고리즘: 앞으로 사용 빈도가 가장 낮은 페이지를 먼저 교체
- LRU 페이지 교체 알고리즘: 가장 오래동안 사용하지 않은 페이지를 먼저 교체

**프레임 할당**
- 스래싱은 프로세스가 실제 실행되는 시간보다 페이징에 더 많은 시간이 소요되는 문제
- 균등 할당: 프로세스마다 같은 수의 프레임 할당
- 비례 할당: 프로세스 크기에 비례하여 프레임 할당
- 작업 집합 모델: 프로세스가 일정 시간 동안 참조한 페이지의 집합인 작업 집합 만큼 할당
- 페이지 폴트 빈도: 페이지 폴트 빈도에 따라 유동적으로 프레임 수를 조절하여 할당